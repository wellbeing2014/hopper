<!--#include virtual="/pub/_meta.shtml" -->  
<style type="text/css">
pre {
white-space: pre-wrap; /* css-3 */
word-wrap: break-word; /* InternetExplorer5.5+ */
white-space: -moz-pre-wrap; /* Mozilla,since1999 */
white-space: -pre-wrap; /* Opera4-6 */
white-space: -o-pre-wrap; /* Opera7 */
margin:0px;
border:0px;
line-height:14px;
font-size:14px;
padding:1px;
}

body{min-height:0}
#log-container{
	
	top: 50px;
	display:block;
	
}
#log-title{
	height:45px;
	position: fixed;
	top: 0;
    left: 0;
    width:100%;
    z-index: 10000;
   background:#e5e5e5;
}
article{
	left: 0;
	margin-top:50px;
}
</style>

<title>日志查看</title>

</head>
<body>
<article class="page-container"   >

<div id="log-title"  >
	<table class="table">
		<tr class="text-c">
					<td><div class="text-l">
		<p class="f-18" id="servertitle"></p>
	</div></td>
					<td><div class="text-r">
		<input type="text" class="input-text" style="width:250px" placeholder="com.wisoft." id="" name="">
		<button type="submit" class="btn btn-success radius" id="" name=""><i class="Hui-iconfont">&#xe665;</i>定位</button>
		
	</div></td>
		</tr>
	</table>
	<div class="line mb-10" style="border-bottom:solid 1px #c00;"></div>
</div>


<div id="log-container"  class="bk-gray radius" >
</div>

<span id="msg_end" style="overflow:hidden"></span>
	
</article>

<!--#include virtual="/pub/_footer.shtml" -->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="/hopper-res/lib/sockjs-1.1.1.js"></script>
<script type="text/javascript" src="/hopper-res/lib/vue/vue.js"></script>
<script type="text/javascript" src="/hopper-res/lib/stomp.js"></script>
<script type="text/javascript" src="/hopper-res/lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="/hopper-res/lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="/hopper-res/lib/jquery.validation/1.14.0/messages_zh.js"></script>
<script type="text/javascript" src="/hopper-res/lib/hopper-common.js"></script>
<script type="text/javascript">



$(function(){
	var serverid = $.getUrlParam('id');
	var stompClient = null;
	if (serverid!=null)
	$.getJSON("/server/getServer.json",{"serverid":serverid},
		    function (json) {
				if(json.success){
					$('#servertitle').text(json.retObj.servername);
					console.log(json.retObj);
					connect(json.retObj.serverid);
				}
					
	});

	
	function connect(logid) {
	    var socket = new SockJS('/hopperserver');
	    stompClient = Stomp.over(socket);
	    stompClient.connect({}, function (frame) {
	        console.log('Connected: ' + frame);
	        stompClient.subscribe('/topic/serverlog/'+logid, function (status) {
	        	$('#log-container').append('<pre>'+status.body+'</pre>');
	        	scrollOffset();
	        });
	    });
	}
	
	function scrollOffset() { 
	$("body,html").animate({ 
	scrollTop: $("#msg_end").offset().top - 70 
	}, 0); 
	}
	
});




</script>
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>